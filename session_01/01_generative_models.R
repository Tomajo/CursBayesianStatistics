##########################################################################################
# @gilbellosta, 2018-05-26
# Generative models
##########################################################################################

#-----------------------------------------------------------------------------------------
# Coin tosses
#-----------------------------------------------------------------------------------------

n <- 100
p <- 0.51
muestra <- rbinom(n, 1, p)


#-----------------------------------------------------------------------------------------
# Traffic accidents
#-----------------------------------------------------------------------------------------

muertos_ano_0 <- rpois(1000, 1160)
muertos_ano_1 <- rpois(1000, 1131)

# Examine the output
hist(muertos_ano_1 - muertos_ano_0)


#-----------------------------------------------------------------------------------------
# Test de Student
#-----------------------------------------------------------------------------------------

mu <- 1.5
incr <- 0.7
sigma <- 0.5

x <- rnorm(13, mu, sigma)
y <- rnorm(15, mu + incr, sigma)

# Check the equality of means
t.test(x, y)


#-----------------------------------------------------------------------------------------
# Simple linear regression
#-----------------------------------------------------------------------------------------

n <- 100

a <- 1.1
b <- 0.3
sigma <- 0.3

x <- runif(n, -5, 5)
y <- rnorm(n, a + b * x, sigma)

plot(x, y)
abline(lm(y ~ x), col = "red")

modelo <- lm(y ~ x)
summary(modelo)


#-----------------------------------------------------------------------------------------
# Hierarchical sales model
#-----------------------------------------------------------------------------------------

n_customers <- 100

lambda_exp <- 0.1
lambda_pois <- 1.3

customer_life <- rexp(n_customers, lambda_exp)

hist(customer_life)

sales <- sapply(customer_life, function(d) rpois(1, lambda_pois * d))

hist(sales)




